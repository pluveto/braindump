---
title: Knowledge-of-Exponent Assumption
date: 2023-11-19T17:50:17.000+08:00
---

## 概念

KEA 是一种用于构造零知识证明（Zero-Knowledge Proof）的密码学假设 [^1]。

此假设大致如下：

- 设 $q$ 是一个素数，使得 $2q+1$ 也是素数（即 [[Safe and Sophie Germain primes|Sophie Germain 素数]]）；
- $g$ 是 $Z_{2q+1}^{*}$ 的阶为 $q$ 的子群的生成元（generator）。

> $Z_{2q+1}^{*}$ 表示模 $2q+1$ 的剩余类 [[Multiplicative Group|乘法群]]，也称为模 $2q+1$ 的单位元素群（unit group modulo $2q+1$）。在这个群中，元素是与 $2q+1$ 互素的 [[Residue Class|剩余类]]，并且群操作是取模 $2q+1$ 的乘法运算。

这意味着 $g$ 是一个满足以下条件的元素：

- $g$ 属于 $Z_{2q+1}^{*}$，也就是模 $2q+1$ 的互质同余类的集合，其中 $q$ 是一个正整数。
- $g$ 的阶（order）是 $q$，也就是说，$g^q \equiv 1 \pmod{2q+1}$，且对于任何小于 $q$ 的正整数 $k$，都有 $g^k \not\equiv 1 \pmod{2q+1}$。
- $g$ 的乘方可以生成 $Z_{2q+1}^{}$ 的一个子群，也就是说，存在一个 $Z_{2q+1}^{}$ 的子集 $H$，使得 $H = {g^0, g^1, g^2, \dots, g^{q-1}}$。

换句话说，$g$ 是 $Z_{2q+1}^{*}$ 的一个循环子群的生成元，这个子群的阶是 $q$。

- 假设我们的输入是 $q, g, g^{a}$，其中：
	- $a$ 是一个未知的指数
	- 目标是输出一对 $(C, Y)$，使得 $Y=C^{a}$ 成立。
- 一种简单的方法是，随机选择一个 $c \in \mathbb{Z}_{q}$，令 $C=g^{c}$，并令 $Y=\left(g^{a}\right)^{c}$。这样，我们就可以保证 $Y=C^{a}$，因为 $Y=\left(g^{a}\right)^{c}=\left(g^{c}\right)^{a}=C^{a}$。
- KEA1 假设的直观含义是，这是生成这样一对 $(C, Y)$ 的唯一方法。换句话说，任何能够输出这样一对 $(C, Y)$ 的敌手，必须“知道”一个指数 $c$，使得 $g^{c}=C$ 成立。
- KEA1 假设的形式化表述是，对于任何能够输出这样一对 $(C, Y)$ 的敌手 $A$，存在一个“提取器” $\overline{\mathbf{A}}$，它可以在给定相同的输入 $q, g, g^{a}$ 的情况下，返回一个指数 $c$，使得 $g^{c}=C$ 成立。

最后这句话可能不太好理解。

这句话的意思是，如果有一个敌手 $A$，它可以根据 $q, g, g^{a}$ 这三个参数，生成一对满足 $Y=C^{a}$ 的值 $(C, Y)$，那么一定有一个方法，可以从 $A$ 的输出中“提取”出一个指数 $c$，使得 $C$ 等于 $g$ 的 $c$ 次方。也就是说，$A$ 不能随意生成 $(C, Y)$，而必须遵循一定的规则，否则就会被“提取器” $\overline{\mathbf{A}}$ 揭穿。

甚至可以断言，生成的 $C=g^c$, $Y=(g^c)^a$

我们可以用一个类比来理解这个假设。

假设有一个魔术师 $A$，他可以根据一个数字 $q$，一个颜色 $g$，和一个形状 $g^{a}$，变出一对物品 $(C, Y)$，其中 $Y$ 的形状和 $C$ 的形状相同，但是颜色不同。

例如，如果 $q=3$，$g$ 是红色，$g^{a}$ 是圆形，那么 $A$ 可能会变出一个红色的圆形 $C$，和一个蓝色的圆形 $Y$。这个魔术看起来很神奇，但是其实有一个秘密。$A$ 必须根据 $g$ 的颜色，选择一个数字 $c$，然后用 $c$ 来决定 $C$ 和 $Y$ 的颜色。

现在，假设有一个揭秘者 $\overline{\mathbf{A}}$，他可以根据 $q, g, g^{a}$ 这三个参数，以及 $A$ 变出的 $(C, Y)$，猜出 $A$ 选择的数字 $c$。例如，如果 $\overline{\mathbf{A}}$ 看到 $C$ 是绿色，$Y$ 是黄色，他就知道 $c=2$。这样，$\overline{\mathbf{A}}$ 就可以“提取”出 $c$，并且揭穿 $A$ 的魔术。这个揭秘者就相当于 KEA1 假设中的“提取器”。

KEA1 假设的含义是，对于任何一个魔术师 $A$，都存在一个揭秘者 $\overline{\mathbf{A}}$，可以根据 $A$ 的魔术，猜出 $A$ 的秘密。也就是说，$A$ 的魔术并不是真正的魔术，而是有一定的规律可循的。

这个假设在密码学中是很有用的，因为它可以用来构造一种特殊的证明，叫做零知识证明。零知识证明是一种让证明者向验证者证明某个陈述是真的，而不泄露任何其他信息的方法。例如，证明者可以用 KEA1 假设来证明他知道 $g^{a}$ 的指数 $a$，而不需要告诉验证者 $a$ 的具体值。这样，证明者就可以保护自己的隐私，而验证者就可以信任证明者的证明。

后文的内容，也就是关于 KEA2 和 KEA3 假设的部分。这些假设是在 KEA1 假设的基础上，增加了一些复杂性和泛化性。

KEA2 假设的大致意思是：

- 给定一个素数 $q$，使得 $2q+1$ 也是素数，以及一个生成 $Z_{2q+1}^{}$ 中阶为 $q$ 的子群的元素 $g$。$Z_{2q+1}^{}$ 是模 $2q+1$ 的互质同余类的集合。
- 假设我们的输入是 $q, g, g^{a}, g^{b}, g^{ab}$，其中 $a$ 和 $b$ 是两个未知的指数，我们的目标是输出一对 $(C, Y)$，使得 $Y=C^{b}$ 成立。
- 一种简单的方法是，随机选择一个 $c \in \mathbb{Z}_{q}$，令 $C=g^{c}$，并令 $Y=\left(g^{b}\right)^{c}$。这样，我们就可以保证 $Y=C^{b}$，因为 $Y=\left(g^{b}\right)^{c}=\left(g^{c}\right)^{b}=C^{b}$。
- 另一种简单的方法是，随机选择一个 $c \in \mathbb{Z}_{q}$，令 $C=\left(g^{a}\right)^{c}$，并令 $Y=\left(g^{ab}\right)^{c}$。这样，我们也可以保证 $Y=C^{b}$，因为 $Y=\left(g^{ab}\right)^{c}=\left(\left(g^{a}\right)^{c}\right)^{b}=C^{b}$。
- KEA2 假设的直观含义是，这是生成这样一对 $(C, Y)$ 的唯一方法。换句话说，任何能够输出这样一对 $(C, Y)$ 的敌手，必须“知道”一个指数 $c$，使得 $g^{c}=C$ 或者 $\left(g^{a}\right)^{c}=C$ 成立。
- KEA2 假设的形式化表述是，对于任何能够输出这样一对 $(C, Y)$ 的敌手 $A$，存在一个“提取器” $\overline{\mathbf{A}}$，它可以在给定相同的输入 $q, g, g^{a}, g^{b}, g^{ab}$ 的情况下，返回一个指数 $c$，使得 $g^{c}=C$ 或者 $\left(g^{a}\right)^{c}=C$ 成立。


- [!] 大佬说 KEA1 假设是不可证伪的。[^2]

## 例子

Alice 想让 Bob 帮忙完成一个基于 $a$ 的计算，$a$ 是一个 [[Generator|生成元]]。并且还要 Bob 证明运算结果的确基于 $a$，怎么做？

- Alice 和 Bob 先协商一个 $n$
- Alice 有一个值 $a$，有一个随机数 $k$，衍生值 $a' \equiv a^k \ (\text{mod}\ n)$
  - 比如说，$a = 3$，$k = 2$，$n = 7$，那么 $a' = 3^2 = 9 \equiv 2 \ (\text{mod}\ 7)$
  - $(a, a') = (3, 2)$ 是 Alice 的证明
- Alice 将 $(a, a')$ 发送给 Bob，并希望得到 $(b, b')\quad \text{s.t.}\ b^k \equiv b' \ (\text{mod}\ n)$
  - 那 Bob 能不能直接回 $(3, 2)$ 给 Alice 呢？不能，规则要求必须是 $a \neq b$
  - 所以 Bob 必须要计算出一个 $b$，使得 $b^k \equiv b' \ (\text{mod}\ n)$，同时又不知道 $k$
  - 于是 Bob 想到一个办法，先计算一个 $c$，比如 3
    - 然后计算 $a^c = 3^3 = 27 \equiv 6 \ (\text{mod}\ 7)$
    - 然后计算 $a'^c = 2^3 = 8 \equiv 1 \ (\text{mod}\ 7)$
  - 这样 $(b, b') = (6, 1)$
- Alice 核验发现，确实 $6^2 \equiv 1 \ (\text{mod}\ 7)$，$1^2 \equiv 1 \ (\text{mod}\ 7)$，所以 $(b, b')$ 是正确的。
  - 这样 Alice 确信，Bob 在元组的两个值的计算上都用了同一个指数（即 $c$）
  - 而且，都是基于 $(a, a')$ 完成的运算。

[^1]: The Knowledge-of-Exponent Assumptions and 3-Round Zero-Knowledge Protocols <https://eprint.iacr.org/2004/008.pdf>
[^2]: discrete logarithm - How much do we trust KEA1 Assumption? - Cryptography Stack Exchange <https://crypto.stackexchange.com/questions/6117/how-much-do-we-trust-kea1-assumption>
