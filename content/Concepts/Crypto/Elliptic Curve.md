---
date: 2023-11-24T07:19:21.000+08:00
aliases:
  - 椭圆曲线
---

**椭圆曲线（Elliptic Curve，EC）** 的方程通常以 Weierstrass 形式表示为：

$$
 y^2 = x^3 + ax + b 
$$

一些函数图像：

![](https://code.wandoer.com/wp-content/uploads/2018/09/ecc.png)

其中 $a$ 和 $b$ 满足 $4a^3 + 27b^2 \neq 0$，这是为了排除特殊曲线 [^1]：

![](https://code.wandoer.com/wp-content/uploads/2018/09/notecc.png)

椭圆曲线上的点加法可以通过几何构造来实现，也可以通过特定的算法来计算。

## 几何构造点加法 [^2]

> 简单来说，如果直线与曲线交于 $P,Q,R$ 三点，定义 $P+Q+R=0$。

设有两个点 $P$ 和 $Q$，它们都在椭圆曲线上。要计算它们的和 $P + Q$，可以按照以下步骤进行：

1. 将直线通过点 $P$ 和点 $Q$，并延长直线，直到它与椭圆曲线相交于第三个点 $R$。这条直线被称为割线。
2. 在点 $R$ 处，将割线与椭圆曲线相切。这条切线与椭圆曲线的交点被定义为点 $P + Q$。

通过这个几何构造，我们可以将点 $P$ 和点 $Q$ 的加法转化为在椭圆曲线上的点的相交和切线的构造。

特殊情况：例如当点 $P$ 和点 $Q$ 重合或者它们的切线与椭圆曲线相交于无穷远点 $\mathcal{O}$。在这种情况下，我们有 $P + P = P$ 和 $P + (-P) = \mathcal{O}$。

递推：这种方法可以用于计算多个点的和，从而实现椭圆曲线上的多倍点运算。通过重复应用点加法，我们可以计算出点的多倍点，例如 $2P, 3P, 4P$ 等。

> 时间复杂度太高，因为涉及到曲线和直线的相交计算。因此 [[Multiplicative Cyclic Group|ECC]] 中通常使用基于有限域上的数学运算的算法来实现点加法。

事实上，椭圆曲线与直线的交点可能不止三个，可能有两个，一个或者没有。

相切，则与给定的点 $P$ 和 $Q$ 相交的直线有两个交点。视作三个点其二重合的情况。

没有交点，视作直线与曲线相交于无穷远点 $\mathcal{O}$。

不会出现四个交点的情况。

## EC 上的 DLP

除了点加法之外，椭圆曲线还具有其他重要的性质，如离散对数问题的困难性。基于椭圆曲线的离散对数问题是指在椭圆曲线上找到满足 $Q = nP$ 的整数 $n$ 的计算困难性，其中 $P$ 是已知点，$Q$ 是待求点。

椭圆曲线展开了传统整数基础的公钥密码学的可能性，提供了更高效和安全的解决方案。它在现代密码学中被广泛应用，为许多安全协议和应用提供了强大的安全性和高效性。

## EC 上的群

在椭圆曲线密码学中，椭圆曲线上的[[Group|群]]是通过曲线上的点以及无穷远点（记为 $\mathcal{O}$，也称为“单位元”或“群的零元”）来定义的。这个群的操作通常被称为“点加”，定义如下：

1. **单位元**：
   - 无穷远点 $\mathcal{O}$ 是群的单位元，对于任何曲线上的点 $P$，$P + \mathcal{O} = P$。

2. **逆元**：
   - 每个点 $P(x, y)$ 都有一个逆元，即 $P'(x, -y)$（在仿射坐标中）。这意味着 $P + P' = \mathcal{O}$。

3. **点加**：
   - 给定曲线上的两个点 $P$ 和 $Q$，如果 $P \neq Q$ 且 $P \neq -Q$，则可以找到第三个点 $R$，使得 $P + Q = R$。这是通过找到过 $P$ 和 $Q$ 的直线，该直线将与曲线相交于第三个点 $R'$，然后通过关于 $x$ 轴的对称变换得到 $R$。

4. **点倍乘**：
   - 如果 $P = Q$，则该操作称为点倍乘。这是通过找到点 $P$ 处曲线的切线来完成的，该切线将与曲线再次相交于另一点 $R'$，然后通过关于 $x$ 轴的对称变换得到 $R$。

这些操作遵循以下几何构造：

- **相异点相加**：对于曲线上的两个相异点 $P$ 和 $Q$，过这两点作一直线，该直线与椭圆曲线相交于第三点 $R'$。点 $R$ 是点 $R'$ 关于 $x$ 轴的对称点，定义 $P + Q = R$。
- **点的加倍**：对于曲线上的一个点 $P$，作该点的切线，该切线与椭圆曲线相交于一点 $R'$。点 $R$ 是点 $R'$ 关于 $x$ 轴的对称点，定义 $P + P = 2P = R$。
- **加法逆元**：对于曲线上的点 $P(x, y)$，其加法逆元是 $P'(x, -y)$。这意味着 $P + P' = \mathcal{O}$，其中 $\mathcal{O}$ 是无穷远点。

在实际应用中，如椭圆曲线密码学，通常使用的是椭圆曲线上的点的[[Finite Field|有限域]]上的群。在有限域上，所有的运算（包括点的加法和乘法）都是模一个质数 $p$ 进行的，这意味着所有的坐标都是在这个有限域内，并且所有的算术运算（加、减、乘、乘方和求逆）都是模 $p$ 的。

[^1]: 参考 <https://code.wandoer.com/note/eccelliptic-curves-cryptography-%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E5%8A%A0%E5%AF%86%E5%8E%9F%E7%90%86.htm>
[^2]: 参考 <https://www.cnblogs.com/cbkj-xd/p/13384713.html>
